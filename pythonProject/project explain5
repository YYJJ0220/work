【project 5】SM2的基本实现和优化
————SM2加密如下：
1.用随机数发生器产生随机数k (1<k<n-1)<br>
2.计算椭圆曲线点C1=[k]G=(x1,y1)，并将其转换为比特串（A的私钥生成公钥）<br>
3.计算椭圆曲线点S=[h]Pb，若S是无穷远点，则报错并退出 h为n的余因子<br>
4.计算椭圆曲线点[k]Pb=(x2,y2)，并将其转换为比特串（A的私钥乘B的公钥）<br>
5.计算t=KDF(x2||y2,klen)，若t为全0比特串，则返回①; KDF为密钥派生函数<br>
6.计算C2=M⊕t<br>
7.计算C3=Hash(x2||M||y2)<br>
8.输出密文C=C1||C3||C2<br>
————SM2解密如下：
1.从C中取出比特串C1，将其转换为椭圆曲线上的点，验证C1是否满足椭圆曲线方程<br>
2.计算椭圆曲线点S=[h]Pb，若S是无穷远点，则报错并退出<br>
3.计算[db]C1=(x2,y2)，并将其转换为比特串 db B的公钥<br>
4.计算t=KDF(x2||y2,klen)，若t为全0比特
